<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>ESS Tools</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col">
                <h1>แบบฟอร์ม</h1>
                <p>インフォメLINEで流すメッセージを簡単に作成出来ます。</p>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form>
                    <div class="form-group">
                        <label for="InputCategory">เลือกจังหวัด</label>
                        <select class="form-control" id="InputCategory">
<option value="กรุงเทพมหานคร">กรุงเทพมหานคร</option>
<option value="กระบี่">กระบี่ </option>
<option value="กาญจนบุรี">กาญจนบุรี </option>
<option value="กาฬสินธุ์">กาฬสินธุ์ </option>
<option value="กำแพงเพชร">กำแพงเพชร </option>
<option value="ขอนแก่น">ขอนแก่น</option>
<option value="จันทบุรี">จันทบุรี</option>
<option value="ฉะเชิงเทรา">ฉะเชิงเทรา </option>
<option value="ชัยนาท">ชัยนาท </option>
<option value="ชัยภูมิ">ชัยภูมิ </option>
<option value="ชุมพร">ชุมพร </option>
<option value="ชลบุรี">ชลบุรี </option>
<option value="เชียงใหม่">เชียงใหม่ </option>
<option value="เชียงราย">เชียงราย </option>
<option value="ตรัง">ตรัง </option>
<option value="ตราด">ตราด </option>
<option value="ตาก">ตาก </option>
<option value="นครนายก">นครนายก </option>
<option value="นครปฐม">นครปฐม </option>
<option value="นครพนม">นครพนม </option>
<option value="นครราชสีมา">นครราชสีมา </option>
<option value="นครศรีธรรมราช">นครศรีธรรมราช </option>
<option value="นครสวรรค์">นครสวรรค์ </option>
<option value="นราธิวาส">นราธิวาส </option>
<option value="น่าน">น่าน </option>
<option value="นนทบุรี">นนทบุรี </option>
<option value="บึงกาฬ">บึงกาฬ</option>
<option value="บุรีรัมย์">บุรีรัมย์</option>
<option value="ประจวบคีรีขันธ์">ประจวบคีรีขันธ์ </option>
<option value="ปทุมธานี">ปทุมธานี </option>
<option value="ปราจีนบุรี">ปราจีนบุรี </option>
<option value="ปัตตานี">ปัตตานี </option>
<option value="พะเยา">พะเยา </option>
<option value="พระนครศรีอยุธยา">พระนครศรีอยุธยา </option>
<option value="พังงา">พังงา </option>
<option value="พิจิตร">พิจิตร </option>
<option value="พิษณุโลก">พิษณุโลก </option>
<option value="เพชรบุรี">เพชรบุรี </option>
<option value="เพชรบูรณ์">เพชรบูรณ์ </option>
<option value="แพร่">แพร่ </option>
<option value="พัทลุง">พัทลุง </option>
<option value="ภูเก็ต">ภูเก็ต </option>
<option value="มหาสารคาม">มหาสารคาม </option>
<option value="มุกดาหาร">มุกดาหาร </option>
<option value="แม่ฮ่องสอน">แม่ฮ่องสอน </option>
<option value="ยโสธร">ยโสธร </option>
<option value="ยะลา">ยะลา </option>
<option value="ร้อยเอ็ด">ร้อยเอ็ด </option>
<option value="ระนอง">ระนอง </option>
<option value="ระยอง">ระยอง </option>
<option value="ราชบุรี">ราชบุรี</option>
<option value="ลพบุรี">ลพบุรี </option>
<option value="ลำปาง">ลำปาง </option>
<option value="ลำพูน">ลำพูน </option>
<option value="เลย">เลย </option>
<option value="ศรีสะเกษ">ศรีสะเกษ</option>
<option value="สกลนคร">สกลนคร</option>
<option value="สงขลา">สงขลา </option>
<option value="สมุทรสาคร">สมุทรสาคร </option>
<option value="สมุทรปราการ">สมุทรปราการ </option>
<option value="สมุทรสงคราม">สมุทรสงคราม </option>
<option value="สระแก้ว">สระแก้ว </option>
<option value="สระบุรี">สระบุรี </option>
<option value="สิงห์บุรี">สิงห์บุรี </option>
<option value="สุโขทัย">สุโขทัย </option>
<option value="สุพรรณบุรี">สุพรรณบุรี </option>
<option value="สุราษฎร์ธานี">สุราษฎร์ธานี </option>
<option value="สุรินทร์">สุรินทร์ </option>
<option value="สตูล">สตูล </option>
<option value="หนองคาย">หนองคาย </option>
<option value="หนองบัวลำภู">หนองบัวลำภู </option>
<option value="อำนาจเจริญ">อำนาจเจริญ </option>
<option value="อุดรธานี">อุดรธานี </option>
<option value="อุตรดิตถ์">อุตรดิตถ์ </option>
<option value="อุทัยธานี">อุทัยธานี </option>
<option value="อุบลราชธานี">อุบลราชธานี</option>
<option value="อ่างทอง">อ่างทอง </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="InputTitle">部会タイトル</label>
                        <input type="text" class="form-control" id="InputTitle" placeholder="3/9の部会">
                    </div>
                    <div class="form-group">
                        <label for="InputGreet">はじめの挨拶</label>
                        <textarea class="form-control" id="InputGreet" rows="3" placeholder="こんにちは！今年度初のテクチ講習会です！PCが好きな方、動画に興味のある方、代替えで動画作ろうと思っている方はぜひお越しください！"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="InputDate">日時</label>
                        <input type="text" class="form-control" id="InputDate" aria-describedby="dateHelp" placeholder="3/9（月）18:30~20:30">
                    </div>
                    <div class="form-group">
                        <label for="InputPlace">開催場所</label>
                        <input type="text" class="form-control" id="InputPlace" aria-describedby="placeHelp"
                            placeholder="K204">
                    </div>
                    <div class="form-group">
                        <label for="InputRequirement">持ち物</label>
                        <input type="text" class="form-control" id="InputRequirement" placeholder="特になし">
                    </div>
                    <div class="form-group">
                        <label for="detailTextarea">内容説明・その他</label>
                        <textarea class="form-control" id="detailTextarea" rows="3" placeholder="動画講習会　使用ソフトはAviutlです！ソフトは事前にお配りするので特に用意は不要です！"></textarea>
                    </div>
                </form>
            </div>
        </div>

        <div class="row">
            <div class="col-auto mx-auto">
                <button id="build" class="btn btn-primary">変換！</button>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <textarea class="form-control" id="resultTextarea" rows="5" placeholder="結果" readonly></textarea>
            </div>
        </div>
        <div class="row">
            <div class="col-auto mx-auto">
                <button id="copy" class="btn btn-primary">コピー</button>
                <button id="send" class="btn btn-primary">トークに貼り付け</button>
            </div>
        </div>

    </div>
    <script src="https://d.line-scdn.net/liff/1.0/sdk.js"></script>
    <script src="liff-starter.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script>
        $(function () {
            $('#send').click(function () {
                var sendText = $('#resultTextarea').val()
                liff.sendMessages([{
                    type: 'text',
                    text: sendText
                }]).then(function () {
                    window.alert("Message sent");
                }).catch(function (error) {
                    window.alert("Error sending message: " + error);
                });
                console.log(sendText);
                liff.closeWindow();
            });
            $('#copy').click(function () {
                var sendText = $('#resultTextarea').val()
                if (execCopy(sendText)) {
                    alert('コピーできました');
                } else {
                    alert('このブラウザでは対応していません');
                }
            });

            $('#build').click(function () {
                var title = $('#InputTitle').val();
                var category = $('#InputCategory').val();
                var greeting = $('#InputGreet').val();
                var date = $('#InputDate').val();
                var requirement = $('#InputRequirement').val();
                var place = $('#InputPlace').val();
                var detail = $('#detailTextarea').val();
                var result =
                    `【${category}】${title}\n${greeting}\n【日時】${date}\n【持ち物】${requirement}\n【場所】${place}\n【詳細・その他】${detail}`;

                console.log(result);
                $('#resultTextarea').val(result)
            });







        });

        function execCopy(string) {
            var temp = document.createElement('div');

            temp.appendChild(document.createElement('pre')).textContent = string;

            var s = temp.style;
            s.position = 'fixed';
            s.left = '-100%';

            document.body.appendChild(temp);
            document.getSelection().selectAllChildren(temp);

            var result = document.execCommand('copy');

            document.body.removeChild(temp);
            return result;
        }
    </script>

</body>
